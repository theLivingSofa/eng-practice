<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>English Practice â€“ Demonstratives, Articles & Jumbled Sentences</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    * {
      box-sizing: border-box;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      margin: 0;
      padding: 0;
      background: #f5f5f5;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
    }

    .container {
      background: #ffffff;
      margin: 24px;
      padding: 24px;
      max-width: 700px;
      width: 100%;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }

    h1 {
      margin: 0 0 4px 0;
      text-align: center;
      font-size: 24px;
    }

    .subtitle {
      text-align: center;
      font-size: 14px;
      color: #666;
      margin-bottom: 16px;
    }

    .tabs {
      display: flex;
      gap: 8px;
      justify-content: center;
      flex-wrap: wrap;
      margin-bottom: 16px;
    }

    .tab-btn {
      padding: 8px 14px;
      border-radius: 999px;
      border: 1px solid #ccc;
      background: #f3f4f6;
      cursor: pointer;
      font-size: 14px;
    }

    .tab-btn.active {
      background: #2563eb;
      color: #ffffff;
      border-color: #2563eb;
    }

    .card {
      background: #f9fafb;
      padding: 16px;
      border-radius: 12px;
      margin-bottom: 12px;
    }

    .label {
      font-size: 12px;
      color: #6b7280;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 4px;
    }

    #question-text {
      font-size: 18px;
      margin-bottom: 8px;
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 8px;
    }

    .option-btn {
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid #d1d5db;
      background: #ffffff;
      cursor: pointer;
      text-align: left;
      font-size: 14px;
    }

    .option-btn.selected {
      border-color: #2563eb;
      background: #e0ecff;
    }

    #jumbled-container {
      margin-top: 8px;
    }

    .chips-holder {
      padding: 8px;
      border-radius: 10px;
      background: #eef2ff;
      min-height: 46px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-bottom: 8px;
    }

    .chip {
      padding: 6px 10px;
      border-radius: 999px;
      background: #dbeafe;
      font-size: 14px;
      cursor: pointer;
    }

    .chip.used {
      opacity: 0.4;
      background: #9ca3af;
      cursor: default;
    }

    .feedback {
      font-size: 14px;
      min-height: 20px;
      margin-top: 6px;
    }

    .feedback.correct {
      color: #16a34a;
    }

    .feedback.incorrect {
      color: #dc2626;
    }

    .counter {
      font-size: 12px;
      color: #6b7280;
      text-align: right;
      margin-top: 4px;
    }

    .score {
      font-size: 12px;
      color: #374151;
      text-align: left;
      margin-top: 4px;
    }

    .controls {
      display: flex;
      gap: 12px;
      justify-content: center;
      margin-top: 16px;
      flex-wrap: wrap;
    }

    button.primary,
    button.secondary {
      padding: 12px 24px;
      font-size: 16px;
      border-radius: 12px;
      cursor: pointer;
    }

    button.primary {
      border: none;
      background: #16a34a;
      color: #ffffff;
    }

    button.secondary {
      border: 1px solid #cbd5f5;
      background: #eff6ff;
      color: #1d4ed8;
    }

    @media (max-width: 480px) {
      .controls {
        flex-direction: column;
      }

      button.primary,
      button.secondary {
        width: 100%;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>English Practice</h1>
    <div class="subtitle">
      Practice demonstratives, articles and jumbled sentences.<br>
      Swati's son made it, please buy it from me. ðŸ¥²
    </div>

    <div class="tabs">
      <button class="tab-btn active" data-category="demonstratives">Demonstratives</button>
      <button class="tab-btn" data-category="articles">Articles</button>
      <button class="tab-btn" data-category="jumbled">Jumbled Sentences</button>
    </div>

    <div class="card">
      <div class="label">Question</div>
      <div id="question-text"></div>

      <!-- MCQ options -->
      <div id="options-container" class="options"></div>

      <!-- Jumbled sentence touch UI -->
      <div id="jumbled-container" style="display:none;">
        <div class="label">Tap words in correct order</div>
        <div class="chips-holder" id="answer-strip"></div>
        <div class="chips-holder" id="jumbled-chips"></div>
      </div>

      <div id="feedback" class="feedback"></div>
      <div id="counter" class="counter"></div>
      <div id="score" class="score"></div>

      <div class="controls">
        <button id="check-btn" class="primary">Check Answer</button>
        <button id="next-btn" class="secondary">Next Question</button>
        <button id="reset-btn" class="secondary">Reset Section</button>
      </div>
    </div>
  </div>

  <script>
    // --------------- QUESTION BANK (your sentences) ----------------

    const questionBank = {
      // DEMONSTRATIVES: using your 1â€“4 sentences as fill-in-the-blank
      demonstratives: [
        {
          type: "mcq",
          text: "______ is my red ball.",
          options: ["This", "That", "These", "Those"],
          answer: "This"
        },
        {
          type: "mcq",
          text: "______ is a big tree.",
          options: ["This", "That", "These", "Those"],
          answer: "That"
        },
        {
          type: "mcq",
          text: "______ are my new shoes.",
          options: ["This", "That", "These", "Those"],
          answer: "These"
        },
        {
          type: "mcq",
          text: "______ are birds in the sky.",
          options: ["This", "That", "These", "Those"],
          answer: "Those"
        }
        // Sentences 5 & 6 are reused in Articles section
      ],

      // ARTICLES: all your blanks + â€œThe colour of the dress is blue.â€
      articles: [
        {
          type: "mcq",
          text: "I see ___ cat.",
          options: ["a", "an", "the"],
          answer: "a"
        },
        {
          type: "mcq",
          text: "She has ___ apple.",
          options: ["a", "an", "the"],
          answer: "an"
        },
        {
          type: "mcq",
          text: "He wants ___ book.",
          options: ["a", "an", "the"],
          answer: "a"
        },
        {
          type: "mcq",
          text: "We saw ___ elephant.",
          options: ["a", "an", "the"],
          answer: "an"
        },
        {
          type: "mcq",
          text: "This is ___ pen.",
          options: ["a", "an", "the"],
          answer: "a"
        },
        {
          type: "mcq",
          text: "There is ___ orange on the table.",
          options: ["a", "an", "the"],
          answer: "an"
        },
        {
          type: "mcq",
          text: "___ colour of the dress is blue.",
          options: ["a", "an", "the"],
          answer: "the"
        }
      ],

      // JUMBLED: your 6 â€œis / This / cat â†’ This is cat.â€ type sentences
      jumbled: [
        {
          type: "jumbled",
          correct: "This is cat.",
          words: ["is", "This", "cat"]
        },
        {
          type: "jumbled",
          correct: "That is dog.",
          words: ["is", "That", "dog"]
        },
        {
          type: "jumbled",
          correct: "These are pens.",
          words: ["are", "These", "pens"]
        },
        {
          type: "jumbled",
          correct: "Those are birds.",
          words: ["are", "Those", "birds"]
        },
        {
          type: "jumbled",
          correct: "This is ball.",
          words: ["is", "This", "ball"]
        },
        {
          type: "jumbled",
          correct: "Those are chairs.",
          words: ["are", "Those", "chairs"]
        }
      ]
    };

    // ------------------- STATE -------------------

    let currentCategory = "demonstratives";

    // For question order per category
    let orderMap = {};   // category -> shuffled indices array
    let indexMap = {};   // category -> current index in that array

    // For scores per category
    let scoreMap = {};   // category -> { asked, correct }

    // To avoid double-counting on multiple checks of same question
    let hasCheckedCurrentQuestion = false;

    // ------------------- DOM REFS -------------------

    const tabButtons = document.querySelectorAll(".tab-btn");
    const questionTextEl = document.getElementById("question-text");
    const optionsContainer = document.getElementById("options-container");
    const jumbledContainer = document.getElementById("jumbled-container");
    const feedbackEl = document.getElementById("feedback");
    const counterEl = document.getElementById("counter");
    const scoreEl = document.getElementById("score");
    const answerStrip = document.getElementById("answer-strip");
    const jumbledChips = document.getElementById("jumbled-chips");
    const checkBtn = document.getElementById("check-btn");
    const nextBtn = document.getElementById("next-btn");
    const resetBtn = document.getElementById("reset-btn");

    // ------------------- HELPERS -------------------

    function shuffleArray(arr) {
      const a = arr.slice();
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        const tmp = a[i];
        a[i] = a[j];
        a[j] = tmp;
      }
      return a;
    }

    function ensureCategory(category) {
      if (!orderMap[category]) {
        const len = questionBank[category].length;
        orderMap[category] = shuffleArray([...Array(len).keys()]);
        indexMap[category] = 0;
      }
      if (!scoreMap[category]) {
        scoreMap[category] = { asked: 0, correct: 0 };
      }
    }

    function getCurrentQuestionIndex(category) {
      ensureCategory(category);
      return orderMap[category][indexMap[category]];
    }

    function advanceQuestion(category) {
      ensureCategory(category);
      indexMap[category] = indexMap[category] + 1;
      const len = orderMap[category].length;
      if (indexMap[category] >= len) {
        // End of cycle: reshuffle, start again
        orderMap[category] = shuffleArray(orderMap[category]);
        indexMap[category] = 0;
      }
    }

    function clearFeedback() {
      feedbackEl.textContent = "";
      feedbackEl.className = "feedback";
    }

    function normalizeSentence(text) {
      return text
        .toLowerCase()
        .replace(/[.?!]/g, "")
        .replace(/\s+/g, " ")
        .trim();
    }

    function updateScoreDisplay() {
      ensureCategory(currentCategory);
      const s = scoreMap[currentCategory];
      scoreEl.textContent =
        "Score this section: " + s.correct + " / " + s.asked;
    }

    // ------------------- RENDER -------------------

    function renderQuestion() {
      ensureCategory(currentCategory);
      hasCheckedCurrentQuestion = false;

      const qList = questionBank[currentCategory];
      const qIndex = getCurrentQuestionIndex(currentCategory);
      const q = qList[qIndex];

      clearFeedback();
      optionsContainer.innerHTML = "";
      answerStrip.innerHTML = "";
      jumbledChips.innerHTML = "";

      if (q.type === "mcq") {
        jumbledContainer.style.display = "none";
        optionsContainer.style.display = "flex";
        questionTextEl.textContent = q.text;

        q.options.forEach(function (opt) {
          const btn = document.createElement("button");
          btn.className = "option-btn";
          btn.textContent = opt;

          btn.addEventListener("click", function () {
            document.querySelectorAll(".option-btn").forEach(function (b) {
              b.classList.remove("selected");
              b.removeAttribute("data-selected");
            });
            btn.classList.add("selected");
            btn.setAttribute("data-selected", "true");
          });

          optionsContainer.appendChild(btn);
        });

      } else if (q.type === "jumbled") {
        optionsContainer.style.display = "none";
        jumbledContainer.style.display = "block";
        questionTextEl.textContent = "Tap the words to make a correct sentence.";

        const shuffledWords = shuffleArray(q.words);

        shuffledWords.forEach(function (word) {
          const chip = document.createElement("div");
          chip.className = "chip";
          chip.textContent = word;

          chip.addEventListener("click", function () {
            if (chip.classList.contains("used")) {
              return;
            }
            chip.classList.add("used");

            const chosen = document.createElement("div");
            chosen.className = "chip";
            chosen.textContent = word;

            chosen.addEventListener("click", function () {
              chosen.remove();
              chip.classList.remove("used");
            });

            answerStrip.appendChild(chosen);
          });

          jumbledChips.appendChild(chip);
        });
      }

      const total = qList.length;
      const currentNumber = (indexMap[currentCategory] || 0) + 1;
      counterEl.textContent =
        "Question " + currentNumber + " of " + total + " in this round";

      updateScoreDisplay();
    }

    // ------------------- CHECKING -------------------

    function checkAnswer() {
      ensureCategory(currentCategory);
      const qIndex = getCurrentQuestionIndex(currentCategory);
      const q = questionBank[currentCategory][qIndex];

      let correctNow = false;

      if (q.type === "mcq") {
        const selectedBtn = document.querySelector(
          ".option-btn[data-selected='true']"
        );

        if (!selectedBtn) {
          feedbackEl.textContent = "Please select an option.";
          feedbackEl.className = "feedback incorrect";
          return;
        }

        const chosen = selectedBtn.textContent;
        const correct = q.answer;

        if (chosen === correct) {
          feedbackEl.textContent = "Correct!";
          feedbackEl.className = "feedback correct";
          correctNow = true;
        } else {
          feedbackEl.textContent =
            'Not quite. Correct answer: "' + correct + '".';
          feedbackEl.className = "feedback incorrect";
        }

      } else if (q.type === "jumbled") {
        const userWords = Array.from(answerStrip.children).map(function (el) {
          return el.textContent;
        });

        if (userWords.length === 0) {
          feedbackEl.textContent = "Tap the words to build the sentence.";
          feedbackEl.className = "feedback incorrect";
          return;
        }

        const userSentence = normalizeSentence(userWords.join(" "));
        const correctSentence = normalizeSentence(q.correct);

        if (userSentence === correctSentence) {
          feedbackEl.textContent = "Correct!";
          feedbackEl.className = "feedback correct";
          correctNow = true;
        } else {
          feedbackEl.textContent =
            'Try again. Correct sentence: "' + q.correct + '"';
          feedbackEl.className = "feedback incorrect";
        }
      }

      // Update score only the FIRST time we check this question
      if (!hasCheckedCurrentQuestion) {
        scoreMap[currentCategory].asked += 1;
        if (correctNow) {
          scoreMap[currentCategory].correct += 1;
        }
        hasCheckedCurrentQuestion = true;
        updateScoreDisplay();
      }
    }

    // ------------------- NAVIGATION -------------------

    function nextQuestion() {
      advanceQuestion(currentCategory);
      renderQuestion();
    }

    function resetSection() {
      // Reset order and scores only for current category
      delete orderMap[currentCategory];
      delete indexMap[currentCategory];
      scoreMap[currentCategory] = { asked: 0, correct: 0 };
      renderQuestion();
    }

    tabButtons.forEach(function (btn) {
      btn.addEventListener("click", function () {
        const cat = btn.getAttribute("data-category");
        if (cat === currentCategory) {
          return;
        }

        currentCategory = cat;
        tabButtons.forEach(function (b) {
          b.classList.remove("active");
        });
        btn.classList.add("active");

        renderQuestion();
      });
    });

    checkBtn.addEventListener("click", checkAnswer);
    nextBtn.addEventListener("click", nextQuestion);
    resetBtn.addEventListener("click", resetSection);

    // ------------------- INIT -------------------

    (function init() {
      ensureCategory(currentCategory);
      renderQuestion();
    })();
  </script>
</body>
</html>
